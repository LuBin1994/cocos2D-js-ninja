{"version":3,"sources":["..\\..\\..\\..\\assets\\script/assets\\script\\player.js"],"names":["cc","Class","extends","Component","properties","anim","jumpHeight","onLoad","node","getComponent","Animation","stop","configInit","onCollisionEnter","other","currentWidth","game","stage","currentPlat","width","currentX","x","nextWidth","nextPlat","nextX","console","log","GameDataManager","isSuccess","isMove","isGameOver","showGameOver","stopAllActions","toolChoose","stick","bridge","fall","y","init","gameInit","run","animState","play","repeatCount","Infinity","drop","distance","_this","time","toFixed","runOver","moveTo","v2","finishRun","callFunc","easing","easeIn","ani","sequence","runAction","successJump","jump","jumpTo","finish","gainScore","scoreAni","showScoreFx","failJump","fninsh1","readyToJump","update","dt","gameConfig","gameMoveSpeed"],"mappings":"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","file":"player.js","sourceRoot":"..\\..\\..\\..\\assets\\script","sourcesContent":["import gameConfig from './gameConfig';\r\nimport GameDataManager from './GameDataManager';\r\ncc.Class({\r\n    extends: cc.Component,\r\n    properties: {\r\n        anim: null,\r\n        jumpHeight: 300,\r\n    },\r\n    onLoad() {\r\n        this.anim = this.node.getComponent(cc.Animation);\r\n        this.stop();\r\n        this.configInit();\r\n    },\r\n    //忍者与鲨鱼碰撞后执行事件\r\n    onCollisionEnter(other) {\r\n        var currentWidth = this.game.stage.currentPlat.width;\r\n        var currentX = this.game.stage.currentPlat.x;\r\n        var nextWidth = this.game.stage.nextPlat.width;\r\n        var nextX = this.game.stage.nextPlat.x;\r\n        if (currentX - currentWidth / 2 < this.node.x && this.node.x < currentX + currentWidth / 2) {\r\n            console.log('位于当前站桩范围内')\r\n        }\r\n        else if (nextX - nextWidth / 2 < this.node.x && this.node.x < nextX + nextWidth / 2) {\r\n            console.log('位于下一站桩范围内')\r\n        }\r\n        else {\r\n            GameDataManager.isSuccess = false;\r\n            GameDataManager.isMove = false;\r\n            GameDataManager.isGameOver = true;\r\n            this.game.showGameOver();\r\n            this.node.stopAllActions();\r\n            switch (GameDataManager.toolChoose) {\r\n                case 0:\r\n                    this.game.stick.node.stopAllActions();\r\n                    break;\r\n                case 1:\r\n                    this.game.bridge.node.stopAllActions();\r\n                    break;\r\n            }\r\n\r\n\r\n            this.fall();\r\n        }\r\n    },\r\n    configInit: function () {\r\n        this.node.x = -210;\r\n        this.node.y = -295;\r\n    },\r\n    init: function (game) {\r\n        this.game = game;\r\n    },\r\n    gameInit: function () {\r\n        this.configInit();\r\n        this.stop();\r\n    },\r\n    //奔跑\r\n    run: function () {\r\n        if (!GameDataManager.isGameOver) {\r\n            var animState = this.anim.play('playerRun');\r\n            animState.repeatCount = Infinity;\r\n        }\r\n    },\r\n    //停下\r\n    stop: function () {\r\n        var animState = this.anim.play('playerStand');\r\n        animState.repeatCount = 1;\r\n    },\r\n    //搭桥失败跑动坠落\r\n    drop: function (distance) {\r\n        var _this = this;\r\n        var time = (distance / 200).toFixed(1);\r\n        var runOver = cc.moveTo(time, cc.v2(-210 + distance, -295));\r\n        var finishRun = cc.callFunc(function () {\r\n            var animState = _this.anim.play('playerFall');\r\n            animState.repeatCount = 1;\r\n        })\r\n        var fall = cc.moveTo(1, cc.v2(-210 + distance, -1000)).easing(cc.easeIn(2.5));\r\n        var ani = cc.sequence(runOver, finishRun, fall);\r\n        this.node.runAction(ani);\r\n    },\r\n    //\r\n    fall() {\r\n        var animState = this.anim.play('playerFall');\r\n        animState.repeatCount = 1;\r\n        var fall = cc.moveTo(0.5, cc.v2(this.node.x, -1000)).easing(cc.easeIn(1));\r\n        this.node.runAction(fall);\r\n    },\r\n    //成功跳跃\r\n    successJump(distance, jumpHeight) {\r\n        var _this = this;\r\n        this.anim.play('playerJump');\r\n        var jump = cc.jumpTo(1, cc.v2(-210 + distance, -295), jumpHeight, 1);\r\n        var finish = cc.callFunc(function () {\r\n            if (GameDataManager.isSuccess) {\r\n                _this.stop();\r\n                GameDataManager.isMove = true;\r\n                _this.game.gainScore();\r\n                _this.game.scoreAni.showScoreFx();\r\n            }\r\n        })\r\n        var ani = cc.sequence(jump, finish)\r\n        this.node.runAction(ani);\r\n    },\r\n    //失败跳跃\r\n    failJump(distance, jumpHeight) {\r\n        var _this = this;\r\n        this.anim.play('playerJump');\r\n        var jump = cc.jumpTo(1, cc.v2(-210 + distance, -295), jumpHeight, 1);\r\n        var fninsh1 = cc.callFunc(function () {\r\n            _this.anim.play('playerFall');\r\n            _this.game.showGameOver();\r\n        });\r\n        var fall = cc.moveTo(1, cc.v2(-210 + distance, -1000)).easing(cc.easeIn(2));\r\n        var ani = cc.sequence(jump, fninsh1, fall);\r\n        this.node.runAction(ani)\r\n    },\r\n    readyToJump() { this.anim.play('playerReadyJump'); },\r\n    update(dt) {\r\n        if (GameDataManager.toolChoose == 2) {\r\n            if (GameDataManager.isSuccess) {\r\n                if (GameDataManager.isMove) {\r\n                    this.node.x -= gameConfig.gameMoveSpeed;\r\n                }\r\n            }\r\n        }\r\n    }\r\n});\r\n"]}