{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\script\\panel/assets\\script\\panel\\rank.js"],"names":["cc","Class","extends","Component","properties","subCanvas","Node","closeBtn","btnSound","default","type","AudioClip","onLoad","init","_this","loader","loadRes","err","prefab","node","instantiate","addChild","GameConfig","IS_WX","CC_WECHATGAME","tex","Texture2D","window","sharedCanvas","width","height","wx","postMessage","messageType","MAIN_MENU_NUM","on","e","stopPropagation","Util","btnEvent","console","log","GameDataManager","isHideSub","GameUITools","unLoadingLayer","start","_updateSubDomainCanvas","openDataContext","getOpenDataContext","canvas","initWithElement","handleLoadedTexture","SpriteFrame","update"],"mappings":";;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;;;AACAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;AAELC,gBAAY;AACRC,mBAAUL,GAAGM,IADL;AAERC,kBAASP,GAAGM,IAFJ;AAGRE,kBAAS;AACLC,qBAAS,IADJ;AAELC,kBAAMV,GAAGW;AAFJ;AAHD,KAFP;AAULC,UAVK,oBAUG;AACJ,aAAKC,IAAL;AACH,KAZI;AAaLA,QAbK,kBAaC;AACF,YAAIC,QAAQ,IAAZ;AACAd,WAAGe,MAAH,CAAUC,OAAV,CAAkB,iBAAlB,EAAqC,UAACC,GAAD,EAAMC,MAAN,EAAiB;AAClD,gBAAI,CAACD,GAAL,EAAU;AACN,oBAAIE,OAAOnB,GAAGoB,WAAH,CAAeF,MAAf,CAAX;AACAJ,sBAAMK,IAAN,CAAWE,QAAX,CAAoBF,IAApB;AACH;AACJ,SALD;AAMA,YAAGG,qBAAWC,KAAd,EAAoB;AAChB,gBAAIC,aAAJ,EAAmB;AACf,qBAAKC,GAAL,GAAW,IAAIzB,GAAG0B,SAAP,EAAX;AACAC,uBAAOC,YAAP,CAAoBC,KAApB,GAA4B,GAA5B;AACAF,uBAAOC,YAAP,CAAoBE,MAApB,GAA6B,IAA7B;AACAC,mBAAGC,WAAH,CAAe;AACXC,iCAAa,CADF,EACK;AAChBC,mCAAeZ,qBAAWY;AAFf,iBAAf;AAIH;AACJ;AACD,aAAKf,IAAL,CAAUgB,EAAV,CAAa,YAAb,EAA0B,UAASC,CAAT,EAAW;AACjCA,cAAEC,eAAF;AACH,SAFD;AAGAC,uBAAKC,QAAL,CAAc,KAAKhC,QAAnB,EAA4B,KAAKC,QAAjC,EAA0C,YAAU;AAChD,gBAAGc,qBAAWC,KAAd,EAAoB;AAChBQ,mBAAGC,WAAH,CAAe,EAACC,aAAa,CAAd,EAAiBC,eAAeZ,qBAAWY,aAA3C,EAAf;AACAM,wBAAQC,GAAR,CAAYC,0BAAgBC,SAA5B;AACA,oBAAGD,0BAAgBC,SAAnB,EAA6B;AACzBH,4BAAQC,GAAR,CAAY,WAAZ;AACAV,uBAAGC,WAAH,CAAe,EAACC,aAAa,CAAd,EAAf;AACH;AACJ;AACDW,kCAAYC,cAAZ,CAA2B/B,MAAMK,IAAjC;AACH,SAVD;AAWH,KA9CI;AA+CL2B,SA/CK,mBA+CI;AACL,aAAKrB,GAAL,GAAW,IAAIzB,GAAG0B,SAAP,EAAX;AACH,KAjDI;;AAkDL;AACA;AACAqB,0BApDK,oCAoDqB;AACtB,YAAI,CAAC,KAAKtB,GAAV,EAAe;AACX;AACH;AACD,YAAIuB,kBAAkBjB,GAAGkB,kBAAH,EAAtB;AACA,YAAIrB,eAAeoB,gBAAgBE,MAAnC;AACA,aAAKzB,GAAL,CAAS0B,eAAT,CAAyBvB,YAAzB;AACA,aAAKH,GAAL,CAAS2B,mBAAT;AACA,aAAK/C,SAAL,GAAiB,IAAIL,GAAGqD,WAAP,CAAmB,KAAK5B,GAAxB,CAAjB;AACH,KA7DI;AA8DL6B,UA9DK,oBA8DK;AACN,YAAGhC,qBAAWC,KAAd,EAAoB;AAChB,iBAAKwB,sBAAL;AACH;AACJ;AAlEI,CAAT","file":"rank.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\panel","sourcesContent":["import Util from '../utils/util';\r\nimport GameUITools from '../utils/GameUITools';\r\nimport GameConfig from '../gameConfig';\r\nimport GameDataManager from '../gameDataManager';\r\ncc.Class({\r\n    extends: cc.Component,\r\n    properties: {\r\n        subCanvas:cc.Node,\r\n        closeBtn:cc.Node,\r\n        btnSound:{\r\n            default: null,\r\n            type: cc.AudioClip\r\n        }\r\n    },\r\n    onLoad(){\r\n        this.init();\r\n    },\r\n    init(){\r\n        var _this = this;\r\n        cc.loader.loadRes(\"panel/subCanvas\", (err, prefab) => {\r\n            if (!err) {\r\n                let node = cc.instantiate(prefab);\r\n                _this.node.addChild(node);\r\n            }\r\n        });\r\n        if(GameConfig.IS_WX){\r\n            if (CC_WECHATGAME) {\r\n                this.tex = new cc.Texture2D();\r\n                window.sharedCanvas.width = 750;\r\n                window.sharedCanvas.height = 1206;\r\n                wx.postMessage({\r\n                    messageType: 2, //获取排行榜\r\n                    MAIN_MENU_NUM: GameConfig.MAIN_MENU_NUM,\r\n                });\r\n            }\r\n        }\r\n        this.node.on('touchstart',function(e){\r\n            e.stopPropagation();\r\n        });\r\n        Util.btnEvent(this.closeBtn,this.btnSound,function(){\r\n            if(GameConfig.IS_WX){\r\n                wx.postMessage({messageType: 3, MAIN_MENU_NUM: GameConfig.MAIN_MENU_NUM,});\r\n                console.log(GameDataManager.isHideSub)\r\n                if(GameDataManager.isHideSub){\r\n                    console.log('关闭排行榜隐藏子域')\r\n                    wx.postMessage({messageType: 5});\r\n                }\r\n            }\r\n            GameUITools.unLoadingLayer(_this.node);\r\n        })\r\n    },\r\n    start () {\r\n        this.tex = new cc.Texture2D();\r\n    },\r\n    //获取排行\r\n    // 刷新开放数据域的纹理\r\n    _updateSubDomainCanvas () {\r\n        if (!this.tex) {\r\n            return;\r\n        }\r\n        var openDataContext = wx.getOpenDataContext();\r\n        var sharedCanvas = openDataContext.canvas;\r\n        this.tex.initWithElement(sharedCanvas);\r\n        this.tex.handleLoadedTexture();\r\n        this.subCanvas = new cc.SpriteFrame(this.tex);\r\n    },\r\n    update () {\r\n        if(GameConfig.IS_WX){\r\n            this._updateSubDomainCanvas();\r\n        }\r\n    }\r\n});"]}