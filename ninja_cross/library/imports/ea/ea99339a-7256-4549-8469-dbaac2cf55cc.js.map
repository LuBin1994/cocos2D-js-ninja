{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\script\\panel/assets\\script\\panel\\rank.js"],"names":["cc","Class","extends","Component","properties","subCanvas","Node","closeBtn","btnSound","default","type","AudioClip","onLoad","init","_this","loader","loadRes","err","prefab","node","instantiate","addChild","GameConfig","IS_WX","CC_WECHATGAME","tex","Texture2D","window","sharedCanvas","width","height","wx","postMessage","messageType","MAIN_MENU_NUM","on","e","stopPropagation","Util","btnEvent","console","log","GameDataManager","isHideSub","GameUITools","unLoadingLayer","start","_updateSubDomainCanvas","openDataContext","getOpenDataContext","canvas","initWithElement","handleLoadedTexture","SpriteFrame","update"],"mappings":";;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;;;AACAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;AAELC,gBAAY;AACRC,mBAAUL,GAAGM,IADL;AAERC,kBAASP,GAAGM,IAFJ;AAGRE,kBAAS;AACLC,qBAAS,IADJ;AAELC,kBAAMV,GAAGW;AAFJ;AAHD,KAFP;AAULC,UAVK,oBAUG;AACJ,aAAKC,IAAL;AACH,KAZI;AAaLA,QAbK,kBAaC;AACF,YAAIC,QAAQ,IAAZ;AACAd,WAAGe,MAAH,CAAUC,OAAV,CAAkB,iBAAlB,EAAqC,UAACC,GAAD,EAAMC,MAAN,EAAiB;AAClD,gBAAI,CAACD,GAAL,EAAU;AACN,oBAAIE,OAAOnB,GAAGoB,WAAH,CAAeF,MAAf,CAAX;AACAJ,sBAAMK,IAAN,CAAWE,QAAX,CAAoBF,IAApB;AACH;AACJ,SALD;AAMA,YAAGG,qBAAWC,KAAd,EAAoB;AAChB,gBAAIC,aAAJ,EAAmB;AACf,qBAAKC,GAAL,GAAW,IAAIzB,GAAG0B,SAAP,EAAX;AACAC,uBAAOC,YAAP,CAAoBC,KAApB,GAA4B,GAA5B;AACAF,uBAAOC,YAAP,CAAoBE,MAApB,GAA6B,IAA7B;AACAC,mBAAGC,WAAH,CAAe;AACXC,iCAAa,CADF,EACK;AAChBC,mCAAeZ,qBAAWY;AAFf,iBAAf;AAIH;AACJ;AACD,aAAKf,IAAL,CAAUgB,EAAV,CAAa,YAAb,EAA0B,UAASC,CAAT,EAAW;AACjCA,cAAEC,eAAF;AACH,SAFD;AAGAC,uBAAKC,QAAL,CAAc,KAAKhC,QAAnB,EAA4B,KAAKC,QAAjC,EAA0C,YAAU;AAChD,gBAAGc,qBAAWC,KAAd,EAAoB;AAChBQ,mBAAGC,WAAH,CAAe,EAACC,aAAa,CAAd,EAAiBC,eAAeZ,qBAAWY,aAA3C,EAAf;AACAM,wBAAQC,GAAR,CAAYC,0BAAgBC,SAA5B;AACA,oBAAGD,0BAAgBC,SAAnB,EAA6B;AACzBH,4BAAQC,GAAR,CAAY,WAAZ;AACAV,uBAAGC,WAAH,CAAe,EAACC,aAAa,CAAd,EAAf;AACH;AACJ;AACDW,kCAAYC,cAAZ,CAA2B/B,MAAMK,IAAjC;AACH,SAVD;AAWH,KA9CI;AA+CL2B,SA/CK,mBA+CI;AACL,aAAKrB,GAAL,GAAW,IAAIzB,GAAG0B,SAAP,EAAX;AACH,KAjDI;;AAkDL;AACA;AACAqB,0BApDK,oCAoDqB;AACtB,YAAI,CAAC,KAAKtB,GAAV,EAAe;AACX;AACH;AACD,YAAIuB,kBAAkBjB,GAAGkB,kBAAH,EAAtB;AACA,YAAIrB,eAAeoB,gBAAgBE,MAAnC;AACA,aAAKzB,GAAL,CAAS0B,eAAT,CAAyBvB,YAAzB;AACA,aAAKH,GAAL,CAAS2B,mBAAT;AACA,aAAK/C,SAAL,GAAiB,IAAIL,GAAGqD,WAAP,CAAmB,KAAK5B,GAAxB,CAAjB;AACH,KA7DI;AA8DL6B,UA9DK,oBA8DK;AACN,YAAGhC,qBAAWC,KAAd,EAAoB;AAChB,iBAAKwB,sBAAL;AACH;AACJ;AAlEI,CAAT","file":"rank.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\panel","sourcesContent":["import Util from '../utils/util';\nimport GameUITools from '../utils/GameUITools';\nimport GameConfig from '../gameConfig';\nimport GameDataManager from '../gameDataManager';\ncc.Class({\n    extends: cc.Component,\n    properties: {\n        subCanvas:cc.Node,\n        closeBtn:cc.Node,\n        btnSound:{\n            default: null,\n            type: cc.AudioClip\n        }\n    },\n    onLoad(){\n        this.init();\n    },\n    init(){\n        var _this = this;\n        cc.loader.loadRes(\"panel/subCanvas\", (err, prefab) => {\n            if (!err) {\n                let node = cc.instantiate(prefab);\n                _this.node.addChild(node);\n            }\n        });\n        if(GameConfig.IS_WX){\n            if (CC_WECHATGAME) {\n                this.tex = new cc.Texture2D();\n                window.sharedCanvas.width = 750;\n                window.sharedCanvas.height = 1206;\n                wx.postMessage({\n                    messageType: 2, //获取排行榜\n                    MAIN_MENU_NUM: GameConfig.MAIN_MENU_NUM,\n                });\n            }\n        }\n        this.node.on('touchstart',function(e){\n            e.stopPropagation();\n        });\n        Util.btnEvent(this.closeBtn,this.btnSound,function(){\n            if(GameConfig.IS_WX){\n                wx.postMessage({messageType: 3, MAIN_MENU_NUM: GameConfig.MAIN_MENU_NUM,});\n                console.log(GameDataManager.isHideSub)\n                if(GameDataManager.isHideSub){\n                    console.log('关闭排行榜隐藏子域')\n                    wx.postMessage({messageType: 5});\n                }\n            }\n            GameUITools.unLoadingLayer(_this.node);\n        })\n    },\n    start () {\n        this.tex = new cc.Texture2D();\n    },\n    //获取排行\n    // 刷新开放数据域的纹理\n    _updateSubDomainCanvas () {\n        if (!this.tex) {\n            return;\n        }\n        var openDataContext = wx.getOpenDataContext();\n        var sharedCanvas = openDataContext.canvas;\n        this.tex.initWithElement(sharedCanvas);\n        this.tex.handleLoadedTexture();\n        this.subCanvas = new cc.SpriteFrame(this.tex);\n    },\n    update () {\n        if(GameConfig.IS_WX){\n            this._updateSubDomainCanvas();\n        }\n    }\n});"]}