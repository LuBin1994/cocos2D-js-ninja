{"version":3,"sources":["..\\..\\..\\..\\assets\\script/assets\\script\\game.js"],"names":["Player","require","Stage","GameBg","Stick","GameOver","ScoreAni","Bridge","Fog","Energy","Shark","cc","Class","extends","Component","properties","player","stage","gameBg","stick","bridge","fog","gameOver","scoreAni","energy","scoreDisplay","Label","scoreGroup","Node","gameOverSound","AudioClip","shark","onLoad","init","Util","gameStartDataInit","configInit","node","opacity","runAction","fadeIn","_this","GameUITools","loadingLayer","GameConfig","IS_WX","on","isScreemCanTouch","GameDataManager","isAnimate","gameTouchStartProcessing","isStartLengthen","gameTouchEndProcessing","modelChoose","parseInt","toolChoose","wx","request","url","INTER_URL","data","header","getStorageSync","method","success","res","console","log","status","gameId","gameLog","info","error","canShowGameOver","continueGame","setStagePosX","showStage","gameInit","x","currentPlat","width","setTool","gameContinueDataInit","string","totalScore","canResurrectTime","advBtn","active","reStartGame","loadingScene","isLengthen","buildBridge","readyToJump","length","getToolLength","moveDistance","Math","floor","distance","height","successOrlose","isShowFog","hideFog","lengthObj","getLength","min","max","culculateScore","isSuccess","isGameOver","Animation","toolRotateAni","setTimeout","run","successJump","jumpHeight","failJump","toolLength","scoreInterval","num","nextPlat","name","replace","centerDistance","abs","nextScore","addScoreGrade","allMove","callbacks","move","gameMoveSpeed","bridgeY","setStick","setBridge","stop","gainScore","showGameOver","showScore","canSoundPlay","audioEngine","playEffect","scheduleOnce","hideStage","navigateBtn","update","dt","isMove","createStage","recycleStage","showScoreFx","canDrop","drop"],"mappings":"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","file":"game.js","sourceRoot":"..\\..\\..\\..\\assets\\script","sourcesContent":["import Util from './utils/util' ;\r\nimport Animation from './utils/animation';\r\nimport GameUITools from './utils/GameUITools';\r\nimport GameConfig from './GameConfig' ;\r\nimport GameDataManager from './gameDataManager';\r\nvar Player = require('player');\r\nvar Stage = require('stage');\r\nvar GameBg = require('gameBg');\r\nvar Stick = require('stick');\r\nvar GameOver = require('GameOver');\r\nvar ScoreAni = require('scoreAni');\r\nvar Bridge = require('bridge');\r\nvar Fog = require('fog');\r\nvar Energy = require('energy');\r\nvar Shark = require('shark');\r\ncc.Class({\r\n    extends: cc.Component,\r\n    properties: {\r\n        player: Player,\r\n        stage: Stage,\r\n        gameBg: GameBg,\r\n        stick: Stick,\r\n        bridge:Bridge,\r\n        fog:Fog,\r\n        gameOver:GameOver,\r\n        scoreAni:ScoreAni,\r\n        energy:Energy,\r\n        scoreDisplay:cc.Label,\r\n        scoreGroup:cc.Node,\r\n        gameOverSound:cc.AudioClip,\r\n        shark:Shark,\r\n    },\r\n    onLoad() {\r\n        this.gameBg.init(this);\r\n        this.stage.init(this);\r\n        this.gameOver.init(this);\r\n        this.energy.init(this);\r\n        this.shark.init(this);\r\n        this.player.init(this);\r\n        Util.gameStartDataInit();\r\n        this.init();\r\n        this.configInit();\r\n        this.node.opacity = 0;\r\n        this.node.runAction(cc.fadeIn(0.5));\r\n    },\r\n    init: function () {\r\n        var _this = this;\r\n        GameUITools.loadingLayer(\"panel/music\");\r\n        if(GameConfig.IS_WX){\r\n            GameUITools.loadingLayer(\"panel/userInfo\");\r\n        }\r\n        this.node.on('touchstart', function () {\r\n            if(GameConfig.isScreemCanTouch && !GameDataManager.isAnimate){\r\n                _this.gameTouchStartProcessing();\r\n            }\r\n        });\r\n        this.node.on('touchend', function () {\r\n            if(GameConfig.isScreemCanTouch){\r\n                if ( GameDataManager.isStartLengthen) {\r\n                    _this.gameTouchEndProcessing();\r\n                }\r\n            }\r\n        });\r\n        //游戏开始获取id\r\n        if(GameConfig.IS_WX){\r\n            var modelChoose = parseInt(GameDataManager.toolChoose)+1\r\n            //游戏开始获取gameId\r\n            wx.request({\r\n                url:GameConfig.INTER_URL+\"game/start\",\r\n                data:{\r\n                    'model':modelChoose\r\n                },\r\n                header: {\r\n                    'content-type': 'application/x-www-form-urlencoded',\r\n                    'Cookie':\"SESSION=\"+wx.getStorageSync('sessionId')\r\n                },\r\n                method: \"POST\",\r\n                success:function (res) {\r\n                    console.log('游戏开始获取gameId返回值：',res.data)\r\n                    if(res.data.status == 1){\r\n                        GameDataManager.gameId = res.data.data;\r\n                    }\r\n                    else{\r\n                        Util.gameLog(res.data.info)\r\n                    }\r\n                },\r\n                error:function () {\r\n                    Util.gameLog(\"game/start接口调用失败\")\r\n                }\r\n            });\r\n\r\n        }\r\n    },\r\n    configInit: function () {\r\n        this.canShowGameOver = true\r\n    },\r\n    //游戏复活\r\n    continueGame: function () {\r\n        this.stage.setStagePosX();\r\n        this.stage.showStage();\r\n        switch(GameDataManager.toolChoose){\r\n            case 0:\r\n                this.stick.gameInit();\r\n                break;\r\n            case 1:\r\n                this.bridge.gameInit();\r\n                break;\r\n            case 2:\r\n                break;\r\n        }\r\n        this.stick.node.x = this.stage.currentPlat.x + this.stage.currentPlat.width / 2;\r\n        this.player.gameInit();\r\n        this.shark.gameInit();\r\n        this.setTool();\r\n        Util.gameContinueDataInit();\r\n        this.configInit();\r\n        this.scoreDisplay.string = GameDataManager.totalScore;\r\n        if(GameConfig.canResurrectTime == 0){\r\n            this.gameOver.advBtn.active = false;\r\n        }\r\n        if(GameDataManager.toolChoose == 2){\r\n            this.energy.gameInit();\r\n        }\r\n        this.scoreGroup.opacity = 255;\r\n    },\r\n    //重开游戏\r\n    reStartGame: function () {\r\n        GameUITools.loadingScene(\"game\");\r\n    },\r\n    /**\r\n     * 游戏触摸开始数据处理\r\n     */\r\n    gameTouchStartProcessing(){\r\n        if(!GameDataManager.isAnimate){\r\n            GameDataManager.isLengthen = true;\r\n            GameDataManager.isStartLengthen = true;\r\n            switch(GameDataManager.toolChoose){\r\n                case 1:\r\n                    this.bridge.buildBridge();\r\n                    break;\r\n                case 2:\r\n                    this.player.readyToJump();\r\n                    break;\r\n            }\r\n        }\r\n    },\r\n    /**\r\n     * 游戏触摸结束数据处理\r\n     */\r\n    gameTouchEndProcessing(){\r\n        GameDataManager.isLengthen = false;\r\n        if(!GameDataManager.isAnimate){\r\n            var length = this.getToolLength();\r\n            if(GameDataManager.toolChoose <= 1){\r\n                GameDataManager.moveDistance =Math.floor(this.stage.currentPlat.x - this.player.node.x + length + this.stage.currentPlat.width/2)\r\n            }\r\n            else{\r\n                var distance = Math.floor(this.energy.energy.height/300*600);\r\n                GameDataManager.moveDistance =Math.floor(this.stage.currentPlat.x - this.player.node.x + distance + this.stage.currentPlat.width/2)\r\n            }\r\n            this.successOrlose(length);\r\n            if(GameDataManager.isShowFog){\r\n                this.fog.hideFog();\r\n            }\r\n            GameDataManager.isAnimate = true;\r\n        }\r\n    },\r\n    /**\r\n     * 计算道具是否能完成过桥\r\n     */\r\n    successOrlose: function (length) {\r\n        var _this = this;\r\n        var lengthObj = this.stage.getLength();\r\n        //判断搭桥是否成功\r\n        if (lengthObj.min <= length && length <= lengthObj.max){\r\n            this.culculateScore(length,lengthObj.min);\r\n            GameDataManager.isSuccess = true\r\n        }\r\n        else {\r\n            GameDataManager.isSuccess = false\r\n        }\r\n\r\n        //道具执行动画\r\n        if(!GameDataManager.isGameOver){\r\n            switch(GameDataManager.toolChoose){\r\n                case 0:\r\n                    //棍子执行动画\r\n                    Animation.toolRotateAni( GameDataManager.isSuccess,this.stick.node);\r\n                    setTimeout(function () { _this.player.run()},700);\r\n                    break;\r\n                case 1:\r\n                    //桥执行动画\r\n                    Animation.toolRotateAni( GameDataManager.isSuccess,this.bridge.node);\r\n                    setTimeout(function () { _this.player.run() },700);\r\n                    break;\r\n                case 2:\r\n                    //跳跃执行动画\r\n                    if(GameDataManager.isSuccess){\r\n                        this.player.successJump(GameDataManager.moveDistance,_this.player.jumpHeight);\r\n                    }\r\n                    else{\r\n                        this.player.failJump(GameDataManager.moveDistance,_this.player.jumpHeight);\r\n                    }\r\n                    break;\r\n            }\r\n        }\r\n    },\r\n    /**\r\n     * 得分计算\r\n     * @param toolLength 道具长度\r\n     * @param distance 站桩距离\r\n     */\r\n    culculateScore:function(toolLength,distance){\r\n        var scoreInterval; //得分区间\r\n        var num = parseInt(this.stage.nextPlat.name.replace(/[^0-9]/ig, \"\"));\r\n        var centerDistance = Math.floor(Math.abs(toolLength-( distance + this.stage.nextPlat.width/2))); //道具顶点与下个站桩中心的距离\r\n        if(num <= 3){\r\n            scoreInterval = Math.floor(this.stage.nextPlat.width/9);\r\n            if(0 <= centerDistance && centerDistance <= 0.5*scoreInterval){\r\n                GameDataManager.nextScore = 5;\r\n                GameDataManager.addScoreGrade = 3;\r\n            }\r\n            else if(0.5*scoreInterval < centerDistance && centerDistance <= 1.5*scoreInterval){\r\n                GameDataManager.nextScore = 4;\r\n                GameDataManager.addScoreGrade = 2;\r\n            }\r\n            else if(1.5*scoreInterval < centerDistance && centerDistance <= 2.5*scoreInterval){\r\n                GameDataManager.nextScore = 3;\r\n                GameDataManager.addScoreGrade = 2;\r\n            }\r\n            else if(2.5*scoreInterval < centerDistance && centerDistance <= 3.5*scoreInterval){\r\n                GameDataManager.nextScore = 2;\r\n                GameDataManager.addScoreGrade = 1;\r\n            }\r\n            else if(3.5*scoreInterval < centerDistance && centerDistance <= 4.5*scoreInterval){\r\n                GameDataManager.nextScore = 1;\r\n                GameDataManager.addScoreGrade = 1;\r\n            }\r\n        }\r\n        else{\r\n            switch(num){\r\n                case 4:\r\n                    scoreInterval = Math.floor(this.stage.nextPlat.width/7);\r\n                    if(0 < centerDistance && centerDistance <= 0.5*scoreInterval){\r\n                        GameDataManager.nextScore = 6;\r\n                        GameDataManager.addScoreGrade = 3;\r\n                    }\r\n                    else if(0.5*scoreInterval <centerDistance && centerDistance <= 1.5*scoreInterval){\r\n                        GameDataManager.nextScore = 5;\r\n                        GameDataManager.addScoreGrade = 2;\r\n                    }\r\n                    else if(1.5*scoreInterval <centerDistance && centerDistance <= 2.5*scoreInterval){\r\n                        GameDataManager.nextScore = 3;\r\n                        GameDataManager.addScoreGrade = 2;\r\n                    }\r\n                    else if(2.5*scoreInterval <centerDistance && centerDistance <= 3.5*scoreInterval){\r\n                        GameDataManager.nextScore = 1;\r\n                        GameDataManager.addScoreGrade = 1;\r\n                    }\r\n                    break;\r\n                case 5:\r\n                    scoreInterval = Math.floor(this.stage.nextPlat.width/5);\r\n                    if(0 < centerDistance && centerDistance <= 0.5*scoreInterval){\r\n                        GameDataManager.nextScore = 7;\r\n                        GameDataManager.addScoreGrade = 3;\r\n                    }\r\n                    else if(0.5*scoreInterval <centerDistance && centerDistance <= 1.5*scoreInterval){\r\n                        GameDataManager.nextScore = 4;\r\n                        GameDataManager.addScoreGrade = 2;\r\n                    }\r\n                    else if(1.5*scoreInterval <centerDistance && centerDistance <= 2.5*scoreInterval){\r\n                        GameDataManager.nextScore = 2;\r\n                        GameDataManager.addScoreGrade = 1;\r\n                    }\r\n                    break;\r\n                case 6:\r\n                    scoreInterval = Math.floor(this.stage.nextPlat.width/3);\r\n                    if(0 < centerDistance && centerDistance <= 0.5*scoreInterval){\r\n                        GameDataManager.nextScore = 8;\r\n                        GameDataManager.addScoreGrade = 3;\r\n                    }\r\n                    else if(0.5*scoreInterval <centerDistance && centerDistance <= 1.5*scoreInterval){\r\n                        GameDataManager.nextScore = 4;\r\n                        GameDataManager.addScoreGrade = 2;\r\n                    }\r\n                    break;\r\n            }\r\n        }\r\n    },\r\n    /**\r\n     * 控制所有节点的移动\r\n     */\r\n    allMove: function (callbacks){\r\n        GameDataManager.move += GameConfig.gameMoveSpeed;\r\n        if (GameDataManager.move > (GameDataManager.moveDistance)) {\r\n            callbacks && callbacks();  //移动完执行\r\n        }\r\n    },\r\n    /**\r\n     * 获取道具长度\r\n     */\r\n    getToolLength:function(){\r\n        switch(GameDataManager.toolChoose){\r\n            case 0:\r\n                return this.stick.node.height;\r\n                break;\r\n            case 1:\r\n                return this.bridge.bridgeY;\r\n                break;\r\n            case 2:\r\n                return Math.floor(this.energy.energy.height/300*600);\r\n                break;\r\n        }\r\n    },\r\n    /**\r\n     * 设置道具\r\n     */\r\n    setTool:function(){\r\n        switch(GameDataManager.toolChoose){\r\n            case 0:\r\n                this.stick.setStick(this.stage.currentPlat.x + this.stage.currentPlat.width / 2)\r\n                break;\r\n            case 1:\r\n                this.bridge.setBridge(this.stage.currentPlat.x + this.stage.currentPlat.width / 2);\r\n                break;\r\n            case 2:\r\n                this.player.stop();\r\n                break;\r\n        }\r\n    },\r\n    //得分\r\n    gainScore: function () {\r\n        GameDataManager.totalScore += GameDataManager.nextScore;\r\n        this.scoreDisplay.string = GameDataManager.totalScore;\r\n    },\r\n    /**\r\n     * 游戏结束显示\r\n     */\r\n    showGameOver: function () {\r\n        var _this = this;\r\n        if (this.canShowGameOver) {\r\n            GameDataManager.isGameOver = true;\r\n            this.gameOver.showScore();\r\n            if(GameDataManager.canSoundPlay){\r\n                cc.audioEngine.playEffect(_this.gameOverSound,false,1);\r\n            }\r\n            this.scheduleOnce(function() {\r\n                switch(GameDataManager.toolChoose){\r\n                    case 0:\r\n                        this.stick.node.opacity = 0;\r\n                        break;\r\n                    case 1:\r\n                        this.bridge.node.opacity = 0;\r\n                        break;\r\n                    case 2:\r\n                        this.energy.node.opacity = 0;\r\n                        break;\r\n                }\r\n                this.scoreGroup.opacity = 0;\r\n                this.gameOver.node.active = true;\r\n                this.stage.hideStage();\r\n            }, 1.5);\r\n            this.fog.hideFog();\r\n            if(GameConfig.canResurrectTime == 0){\r\n                this.gameOver.advBtn.active = false;\r\n                this.gameOver.navigateBtn.active = true;\r\n                //this.gameOver.btnGroup.y = -270;\r\n            }\r\n            else{\r\n                this.gameOver.advBtn.active = true;\r\n                this.gameOver.navigateBtn.active = false\r\n                //this.gameOver.btnGroup.y = -390;\r\n            }\r\n        }\r\n        this.canShowGameOver = false;\r\n    },\r\n    update(dt) {\r\n        var _this = this;\r\n        if (GameDataManager.isAnimate) {\r\n            //所有对象移动，以及移动完的回调\r\n            if (GameDataManager.isMove) {\r\n                if(GameDataManager.isSuccess){\r\n                    this.allMove(function () {\r\n                        if(GameDataManager.isSuccess){\r\n                            GameDataManager.isMove = false;\r\n                            GameDataManager.isAnimate = false;\r\n                            GameDataManager.move = 0;\r\n                            _this.stage.createStage();\r\n                            _this.stage.recycleStage();\r\n                            if(GameDataManager.toolChoose !== 2){\r\n                                _this.gainScore();\r\n                                _this.scoreAni.showScoreFx();\r\n                            }\r\n                            _this.setTool();\r\n                            _this.player.stop();\r\n                            if(GameDataManager.toolChoose == 2){\r\n                                _this.energy.configInit();\r\n                            }\r\n                            GameDataManager.isStartLengthen = false;\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n            //人物掉落动画\r\n            if (!GameDataManager.isSuccess) {\r\n                if (GameDataManager.canDrop) {\r\n                    var moveDistance = this.stage.currentPlat.x-this.player.node.x+this.stage.currentPlat.width/2\r\n                    this.player.drop(moveDistance);\r\n                    this.showGameOver();\r\n                    GameDataManager.canDrop = false;\r\n                }\r\n            }\r\n        }\r\n    }\r\n});\r\n\r\n"]}