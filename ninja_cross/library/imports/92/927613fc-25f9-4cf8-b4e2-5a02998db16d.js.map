{"version":3,"sources":["..\\..\\..\\..\\assets\\script/assets\\script\\player.js"],"names":["cc","Class","extends","Component","properties","anim","jumpHeight","onLoad","node","getComponent","Animation","stop","configInit","onCollisionEnter","other","currentWidth","game","stage","currentPlat","width","currentX","x","nextWidth","nextPlat","nextX","console","log","GameDataManager","isSuccess","isMove","isGameOver","showGameOver","stopAllActions","stick","bridge","fall","y","init","gameInit","run","animState","play","repeatCount","Infinity","drop","distance","_this","runOver","moveTo","v2","finishRun","callFunc","easing","easeIn","ani","sequence","runAction","successJump","jump","jumpTo","finish","gainScore","scoreAni","showScoreFx","failJump","fninsh1","readyToJump","update","dt","toolChoose","gameConfig","gameMoveSpeed"],"mappings":"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","file":"player.js","sourceRoot":"..\\..\\..\\..\\assets\\script","sourcesContent":["import gameConfig from './gameConfig';\r\nimport GameDataManager from './GameDataManager';\r\ncc.Class({\r\n    extends: cc.Component,\r\n    properties: {\r\n        anim:null,\r\n        jumpHeight:300,\r\n    },\r\n    onLoad(){\r\n        this.anim = this.node.getComponent(cc.Animation);\r\n        this.stop();\r\n        this.configInit();\r\n    },\r\n    //忍者与鲨鱼碰撞后执行事件\r\n    onCollisionEnter(other){\r\n        var currentWidth = this.game.stage.currentPlat.width;\r\n        var currentX = this.game.stage.currentPlat.x;\r\n        var nextWidth = this.game.stage.nextPlat.width;\r\n        var nextX= this.game.stage.nextPlat.x;\r\n        console.log(this.node.x)\r\n        console.log(currentWidth/2,currentX,nextWidth,nextX)\r\n        if(currentX-currentWidth/2 < this.node.x && this.node.x < currentX+currentWidth/2){\r\n            console.log('位于当前站桩范围内')\r\n        }\r\n        else if(nextX-nextWidth/2 < this.node.x && this.node.x < nextX+nextWidth/2){\r\n            console.log('位于下一站桩范围内')\r\n        }\r\n        else{\r\n            GameDataManager.isSuccess = false;\r\n            GameDataManager.isMove = false;\r\n            GameDataManager.isGameOver = true;\r\n            this.game.showGameOver();\r\n            this.node.stopAllActions();\r\n            this.game.stick.node.stopAllActions();\r\n            this.game.bridge.node.stopAllActions();\r\n            this.fall();\r\n        }\r\n    },\r\n    configInit:function(){\r\n        this.node.x = -210;\r\n        this.node.y = -295;\r\n    },\r\n    init:function(game){\r\n        this.game = game;\r\n    },\r\n    gameInit:function(){\r\n        this.configInit();\r\n        this.stop();\r\n    },\r\n    //奔跑\r\n    run:function(){\r\n        if(!GameDataManager.isGameOver){\r\n            var animState = this.anim.play('playerRun');\r\n            animState.repeatCount = Infinity;\r\n        }\r\n    },\r\n    //停下\r\n    stop:function(){\r\n        var animState = this.anim.play('playerStand');\r\n        animState.repeatCount = 1;\r\n    },\r\n    //坠落\r\n    drop:function(distance){\r\n        var _this = this;\r\n        var runOver = cc.moveTo(0.5,cc.v2(-210+distance,-295));\r\n        var finishRun = cc.callFunc(function () {\r\n            var animState = _this.anim.play('playerFall');\r\n            animState.repeatCount = 1;\r\n        })\r\n        var fall = cc.moveTo(1,cc.v2(-210+distance,-1000)).easing(cc.easeIn(2.5));\r\n        var ani = cc.sequence(runOver,finishRun,fall);\r\n        this.node.runAction(ani);\r\n    },\r\n    fall(){\r\n        var animState = this.anim.play('playerFall');\r\n        animState.repeatCount = 1;\r\n        var fall = cc.moveTo(1,cc.v2(this.node.x,-1000)).easing(cc.easeIn(2.5));\r\n        this.node.runAction(fall);\r\n    },\r\n    //成功跳跃\r\n    successJump(distance,jumpHeight){\r\n        var _this = this;\r\n        this.anim.play('playerJump');\r\n        var jump = cc.jumpTo(1,cc.v2(-210+distance,-295),jumpHeight,1);\r\n        var finish = cc.callFunc(function (){\r\n            if(GameDataManager.isSuccess){\r\n                _this.stop();\r\n                GameDataManager.isMove = true;\r\n                _this.game.gainScore();\r\n                _this.game.scoreAni.showScoreFx();\r\n            }\r\n        })\r\n        var ani = cc.sequence(jump,finish)\r\n        this.node.runAction(ani);\r\n    },\r\n    //失败跳跃\r\n    failJump(distance,jumpHeight){\r\n        var _this = this;\r\n        this.anim.play('playerJump');\r\n        var jump = cc.jumpTo(1, cc.v2(-210 + distance, -295), jumpHeight, 1);\r\n        var fninsh1 = cc.callFunc(function () {\r\n            _this.anim.play('playerFall');\r\n            _this.game.showGameOver();\r\n        });\r\n        var fall = cc.moveTo(1.5, cc.v2(-210 + distance, -1000)).easing(cc.easeIn(2));\r\n        var ani = cc.sequence(jump, fninsh1, fall);\r\n        this.node.runAction(ani)\r\n    },\r\n    readyToJump(){\r\n        this.anim.play('playerReadyJump');\r\n    },\r\n    update (dt) {\r\n        if(GameDataManager.toolChoose == 2){\r\n            if (GameDataManager.isSuccess) {\r\n                if (GameDataManager.isMove) {\r\n                    this.node.x -= gameConfig.gameMoveSpeed;\r\n                }\r\n            }\r\n        }\r\n    }\r\n});\r\n"]}