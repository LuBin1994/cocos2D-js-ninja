{"version":3,"sources":["..\\..\\..\\..\\assets\\script/assets\\script\\player.js"],"names":["cc","Class","extends","Component","properties","anim","jumpHeight","onLoad","node","getComponent","Animation","stop","configInit","onCollisionEnter","other","currentWidth","game","stage","currentPlat","width","currentX","x","nextWidth","nextPlat","nextX","console","log","GameDataManager","isSuccess","isMove","isGameOver","showGameOver","stopAllActions","stick","bridge","fall","y","init","gameInit","run","animState","play","repeatCount","Infinity","drop","distance","_this","time","toFixed","runOver","moveTo","v2","finishRun","callFunc","easing","easeIn","ani","sequence","runAction","successJump","jump","jumpTo","finish","gainScore","scoreAni","showScoreFx","failJump","fninsh1","readyToJump","update","dt","toolChoose","gameConfig","gameMoveSpeed"],"mappings":"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","file":"player.js","sourceRoot":"..\\..\\..\\..\\assets\\script","sourcesContent":["import gameConfig from './gameConfig';\r\nimport GameDataManager from './GameDataManager';\r\ncc.Class({\r\n    extends: cc.Component,\r\n    properties: {\r\n        anim:null,\r\n        jumpHeight:300,\r\n    },\r\n    onLoad(){\r\n        this.anim = this.node.getComponent(cc.Animation);\r\n        this.stop();\r\n        this.configInit();\r\n    },\r\n    //忍者与鲨鱼碰撞后执行事件\r\n    onCollisionEnter(other){\r\n        var currentWidth = this.game.stage.currentPlat.width;\r\n        var currentX = this.game.stage.currentPlat.x;\r\n        var nextWidth = this.game.stage.nextPlat.width;\r\n        var nextX= this.game.stage.nextPlat.x;\r\n        if(currentX-currentWidth/2 < this.node.x && this.node.x < currentX+currentWidth/2){\r\n            console.log('位于当前站桩范围内')\r\n        }\r\n        else if(nextX-nextWidth/2 < this.node.x && this.node.x < nextX+nextWidth/2){\r\n            console.log('位于下一站桩范围内')\r\n        }\r\n        else{\r\n            GameDataManager.isSuccess = false;\r\n            GameDataManager.isMove = false;\r\n            GameDataManager.isGameOver = true;\r\n            this.game.showGameOver();\r\n            this.node.stopAllActions();\r\n            this.game.stick.node.stopAllActions();\r\n            this.game.bridge.node.stopAllActions();\r\n            this.fall();\r\n        }\r\n    },\r\n    configInit:function(){\r\n        this.node.x = -210;\r\n        this.node.y = -295;\r\n    },\r\n    init:function(game){\r\n        this.game = game;\r\n    },\r\n    gameInit:function(){\r\n        this.configInit();\r\n        this.stop();\r\n    },\r\n    //奔跑\r\n    run:function(){\r\n        if(!GameDataManager.isGameOver){\r\n            var animState = this.anim.play('playerRun');\r\n            animState.repeatCount = Infinity;\r\n        }\r\n    },\r\n    //停下\r\n    stop:function(){\r\n        var animState = this.anim.play('playerStand');\r\n        animState.repeatCount = 1;\r\n    },\r\n    //坠落\r\n    drop:function(distance){\r\n        var _this = this;\r\n        var time = (distance/200).toFixed(1);\r\n        var runOver = cc.moveTo(time,cc.v2(-210+distance,-295));\r\n        var finishRun = cc.callFunc(function () {\r\n            var animState = _this.anim.play('playerFall');\r\n            animState.repeatCount = 1;\r\n        })\r\n        var fall = cc.moveTo(1,cc.v2(-210+distance,-1000)).easing(cc.easeIn(2.5));\r\n        var ani = cc.sequence(runOver,finishRun,fall);\r\n        this.node.runAction(ani);\r\n    },\r\n    fall(){\r\n        var animState = this.anim.play('playerFall');\r\n        animState.repeatCount = 1;\r\n        var fall = cc.moveTo(1,cc.v2(this.node.x,-1000)).easing(cc.easeIn(2.5));\r\n        this.node.runAction(fall);\r\n    },\r\n    //成功跳跃\r\n    successJump(distance,jumpHeight){\r\n        var _this = this;\r\n        this.anim.play('playerJump');\r\n        var jump = cc.jumpTo(1,cc.v2(-210+distance,-295),jumpHeight,1);\r\n        var finish = cc.callFunc(function (){\r\n            if(GameDataManager.isSuccess){\r\n                _this.stop();\r\n                GameDataManager.isMove = true;\r\n                _this.game.gainScore();\r\n                _this.game.scoreAni.showScoreFx();\r\n            }\r\n        })\r\n        var ani = cc.sequence(jump,finish)\r\n        this.node.runAction(ani);\r\n    },\r\n    //失败跳跃\r\n    failJump(distance,jumpHeight){\r\n        var _this = this;\r\n        this.anim.play('playerJump');\r\n        var jump = cc.jumpTo(1, cc.v2(-210 + distance, -295), jumpHeight, 1);\r\n        var fninsh1 = cc.callFunc(function () {\r\n            _this.anim.play('playerFall');\r\n            _this.game.showGameOver();\r\n        });\r\n        var fall = cc.moveTo(1.5, cc.v2(-210 + distance, -1000)).easing(cc.easeIn(2));\r\n        var ani = cc.sequence(jump, fninsh1, fall);\r\n        this.node.runAction(ani)\r\n    },\r\n    readyToJump(){ this.anim.play('playerReadyJump');},\r\n    update (dt) {\r\n        if(GameDataManager.toolChoose == 2){\r\n            if (GameDataManager.isSuccess) {\r\n                if (GameDataManager.isMove) {\r\n                    this.node.x -= gameConfig.gameMoveSpeed;\r\n                }\r\n            }\r\n        }\r\n    }\r\n});\r\n"]}