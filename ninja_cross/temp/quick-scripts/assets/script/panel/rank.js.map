{"version":3,"sources":["rank.js"],"names":["cc","Class","extends","Component","properties","subCanvas","Node","closeBtn","btnSound","default","type","AudioClip","onLoad","init","_this","loader","loadRes","err","prefab","node","instantiate","addChild","GameConfig","IS_WX","CC_WECHATGAME","tex","Texture2D","window","sharedCanvas","width","height","wx","postMessage","messageType","MAIN_MENU_NUM","on","e","stopPropagation","Util","btnEvent","GameUITools","unLoadingLayer","start","_updateSubDomainCanvas","openDataContext","getOpenDataContext","canvas","initWithElement","handleLoadedTexture","SpriteFrame","update"],"mappings":";;;;;;AAAA;;;;AACA;;;;AACA;;;;;;AACAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;AAELC,gBAAY;AACRC,mBAAUL,GAAGM,IADL;AAERC,kBAASP,GAAGM,IAFJ;AAGRE,kBAAS;AACLC,qBAAS,IADJ;AAELC,kBAAMV,GAAGW;AAFJ;AAHD,KAFP;AAULC,UAVK,oBAUG;AACJ,aAAKC,IAAL;AACH,KAZI;AAaLA,QAbK,kBAaC;AACF,YAAIC,QAAQ,IAAZ;AACAd,WAAGe,MAAH,CAAUC,OAAV,CAAkB,iBAAlB,EAAqC,UAACC,GAAD,EAAMC,MAAN,EAAiB;AAClD,gBAAI,CAACD,GAAL,EAAU;AACN,oBAAIE,OAAOnB,GAAGoB,WAAH,CAAeF,MAAf,CAAX;AACAJ,sBAAMK,IAAN,CAAWE,QAAX,CAAoBF,IAApB;AACH;AACJ,SALD;AAMA,YAAGG,qBAAWC,KAAd,EAAoB;AAChB,gBAAIC,aAAJ,EAAmB;AACf,qBAAKC,GAAL,GAAW,IAAIzB,GAAG0B,SAAP,EAAX;AACAC,uBAAOC,YAAP,CAAoBC,KAApB,GAA4B,GAA5B;AACAF,uBAAOC,YAAP,CAAoBE,MAApB,GAA6B,IAA7B;AACAC,mBAAGC,WAAH,CAAe;AACXC,iCAAa,CADF,EACK;AAChBC,mCAAeZ,qBAAWY;AAFf,iBAAf;AAIH;AACJ;AACD,aAAKf,IAAL,CAAUgB,EAAV,CAAa,YAAb,EAA0B,UAASC,CAAT,EAAW;AACjCA,cAAEC,eAAF;AACH,SAFD;AAGAC,uBAAKC,QAAL,CAAc,KAAKhC,QAAnB,EAA4B,KAAKC,QAAjC,EAA0C,YAAY;AAClD,gBAAGc,qBAAWC,KAAd,EAAoB;AAChBQ,mBAAGC,WAAH,CAAe,EAACC,aAAa,CAAd,EAAiBC,eAAeZ,qBAAWY,aAA3C,EAAf;AACH;AACDM,kCAAYC,cAAZ,CAA2B3B,MAAMK,IAAjC;AACH,SALD;AAMH,KAzCI;AA0CLuB,SA1CK,mBA0CI;AACL,aAAKjB,GAAL,GAAW,IAAIzB,GAAG0B,SAAP,EAAX;AACH,KA5CI;;AA6CL;AACA;AACAiB,0BA/CK,oCA+CqB;AACtB,YAAI,CAAC,KAAKlB,GAAV,EAAe;AACX;AACH;AACD,YAAImB,kBAAkBb,GAAGc,kBAAH,EAAtB;AACA,YAAIjB,eAAegB,gBAAgBE,MAAnC;AACA,aAAKrB,GAAL,CAASsB,eAAT,CAAyBnB,YAAzB;AACA,aAAKH,GAAL,CAASuB,mBAAT;AACA,aAAK3C,SAAL,GAAiB,IAAIL,GAAGiD,WAAP,CAAmB,KAAKxB,GAAxB,CAAjB;AACH,KAxDI;AAyDLyB,UAzDK,oBAyDK;AACN,YAAG5B,qBAAWC,KAAd,EAAoB;AAChB,iBAAKoB,sBAAL;AACH;AACJ;AA7DI,CAAT","file":"rank.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\panel","sourcesContent":["import Util from '../utils/util';\nimport GameUITools from '../utils/GameUITools';\nimport GameConfig from '../gameConfig';\ncc.Class({\n    extends: cc.Component,\n    properties: {\n        subCanvas:cc.Node,\n        closeBtn:cc.Node,\n        btnSound:{\n            default: null,\n            type: cc.AudioClip\n        }\n    },\n    onLoad(){\n        this.init();\n    },\n    init(){\n        var _this = this;\n        cc.loader.loadRes(\"panel/subCanvas\", (err, prefab) => {\n            if (!err) {\n                let node = cc.instantiate(prefab);\n                _this.node.addChild(node);\n            }\n        });\n        if(GameConfig.IS_WX){\n            if (CC_WECHATGAME) {\n                this.tex = new cc.Texture2D();\n                window.sharedCanvas.width = 750;\n                window.sharedCanvas.height = 1206;\n                wx.postMessage({\n                    messageType: 2, //获取排行榜\n                    MAIN_MENU_NUM: GameConfig.MAIN_MENU_NUM,\n                });\n            }\n        }\n        this.node.on('touchstart',function(e){\n            e.stopPropagation();\n        });\n        Util.btnEvent(this.closeBtn,this.btnSound,function () {\n            if(GameConfig.IS_WX){\n                wx.postMessage({messageType: 3, MAIN_MENU_NUM: GameConfig.MAIN_MENU_NUM,});\n            }\n            GameUITools.unLoadingLayer(_this.node);\n        })\n    },\n    start () {\n        this.tex = new cc.Texture2D();\n    },\n    //获取排行\n    // 刷新开放数据域的纹理\n    _updateSubDomainCanvas () {\n        if (!this.tex) {\n            return;\n        }\n        var openDataContext = wx.getOpenDataContext();\n        var sharedCanvas = openDataContext.canvas;\n        this.tex.initWithElement(sharedCanvas);\n        this.tex.handleLoadedTexture();\n        this.subCanvas = new cc.SpriteFrame(this.tex);\n    },\n    update () {\n        if(GameConfig.IS_WX){\n            this._updateSubDomainCanvas();\n        }\n    }\n});"]}