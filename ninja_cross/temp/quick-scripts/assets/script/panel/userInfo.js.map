{"version":3,"sources":["userInfo.js"],"names":["cc","Class","extends","Component","properties","nickName","Label","avatar","Sprite","onLoad","_this","node","active","login","e","Util","gameLog","unLoginedSetting","GameConfig","IS_AUTHORIZE","wx","getSetting","success","res","authSetting","console","log","loginWithWxAuthorize","getUserInfo","userInfo","avatarUrl","string","loader","load","err","texture","sprite","SpriteFrame","spriteFrame","loginWithoutWxAuthorize","getSystemInfo","width","screenWidth","height","screenHeight","auths_Btn","createUserInfoButton","type","image","style","left","Math","floor","top","onTap","res1","auths","hide","director","getScene","children","getChildByName","sendUserInfo","show","fail","loginedSetting","request","url","INTER_URL","data","code","country","province","city","sex","enterShareConfig","enterShareCode","method","header","status","setStorageSync","sessionId","shareCode","error","getComponent","getStorageSync","callBacks","callback","gender","checkLogin","callbacks","haveCheckLogin","checkSession"],"mappings":"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","file":"userInfo.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\panel","sourcesContent":["import GameConfig from '../gameConfig';\nimport Util from '../utils/util'\ncc.Class({\n    extends: cc.Component,\n    properties: {\n        nickName:cc.Label,\n        avatar:cc.Sprite\n    },\n    onLoad(){\n        var _this = this\n        this.node.active = false;\n        try{\n           _this.login();\n        }\n        catch (e){\n            Util.gameLog(\"用户授权模块错误\")\n        }\n    },\n    //未登陆处理\n    unLoginedSetting(){\n        var _this = this\n        if(GameConfig.IS_AUTHORIZE == false){\n            wx.getSetting({\n                    success: function(res){\n                        //已经授权\n                        if(res.authSetting['scope.userInfo']){\n                            console.log('==已获得登录权限==')\n                            _this.node.active = true;\n                            GameConfig.IS_AUTHORIZE = true;\n                            _this.loginWithWxAuthorize();\n                            //获取用户信息,显示头像\n                            wx.getUserInfo({\n                                success: function (res) {\n                                    GameConfig.userInfo.nickName = res.userInfo.nickName;\n                                    GameConfig.userInfo.avatarUrl = res.userInfo.avatarUrl + '?aaa=aa.jpg';\n                                    _this.nickName.string = res.userInfo.nickName;\n                                    cc.loader.load(GameConfig.userInfo.avatarUrl, function (err, texture) {\n                                        var sprite = new cc.SpriteFrame(texture);\n                                        _this.avatar.spriteFrame = sprite;\n                                    });\n                                }\n                            })\n                        }\n                        //未授权\n                        else{\n                            _this.loginWithoutWxAuthorize();\n                            //获取手机信息\n                            wx.getSystemInfo({\n                                success(res){\n                                    var width = res.screenWidth;\n                                    var height = res.screenHeight;\n                                    console.log(width,height)\n                                    if(GameConfig.auths_Btn == null){\n                                        GameConfig.auths_Btn = wx.createUserInfoButton({\n                                            type: 'image',\n                                            image: 'https://st.gwold.com/wfclb/ninja/pic/authorBtn.png',\n                                            style: {\n                                                left: width/2-30-Math.floor(250*width/750),\n                                                top: height/2-30-Math.floor(500*height/1206),\n                                                width:60,\n                                                height:60\n                                            }\n                                        })\n                                        GameConfig.auths_Btn.onTap((res1) => {\n                                            wx.getSetting({\n                                                success(auths){\n                                                    if(auths.authSetting[\"scope.userInfo\"]){\n                                                        console.log(\"==已经授权===\")\n                                                        GameConfig.IS_AUTHORIZE = true;\n                                                        GameConfig.auths_Btn.hide();\n                                                        var userInfo=cc.director.getScene().children[0].getChildByName(\"userInfo\");\n                                                        userInfo.active = true\n                                                        //将用户信息传至开发者服务器\n                                                        _this.sendUserInfo();\n                                                    }\n                                                    else{\n                                                        console.log(\"==拒绝授权===\")\n                                                    }\n                                                }\n                                            })\n                                        })\n                                        GameConfig.auths_Btn.show()\n                                    }\n                                }\n                            })\n                        }\n                    },\n                    fail:function () {\n                        Util.gameLog(\"wx.getSetting调用失败\")\n                    }\n                })\n        }\n        else{\n            console.log(\"当前已手动授权\")\n            this.node.active = true;\n            if(GameConfig.auths_Btn){\n                GameConfig.auths_Btn.hide();\n            }\n            this.nickName.string = GameConfig.userInfo.nickName;\n            cc.loader.load(GameConfig.userInfo.avatarUrl, function (err, texture) {\n                var sprite  = new cc.SpriteFrame(texture);\n                _this.avatar.spriteFrame = sprite;\n            });\n        }\n    },\n    //已登陆处理\n    loginedSetting(){\n        var _this = this\n        if(GameConfig.IS_AUTHORIZE == false){\n            wx.getSetting({\n                success: function(res){\n                    //已经授权\n                    if(res.authSetting['scope.userInfo']){\n                        console.log('==已获得登录权限==')\n                        _this.node.active = true;\n                        GameConfig.IS_AUTHORIZE = true;\n                        //获取用户信息,显示头像\n                        wx.getUserInfo({\n                            success: function (res) {\n                                GameConfig.userInfo.nickName = res.userInfo.nickName;\n                                GameConfig.userInfo.avatarUrl = res.userInfo.avatarUrl + '?aaa=aa.jpg';\n                                _this.nickName.string = res.userInfo.nickName;\n                                cc.loader.load(GameConfig.userInfo.avatarUrl, function (err, texture) {\n                                    var sprite = new cc.SpriteFrame(texture);\n                                    _this.avatar.spriteFrame = sprite;\n                                });\n                            }\n                        })\n                    }\n                    //未授权\n                    else{\n                        //获取手机信息\n                        wx.getSystemInfo({\n                            success(res){\n                                var width = res.screenWidth;\n                                var height = res.screenHeight;\n                                console.log(width,height)\n                                if(GameConfig.auths_Btn == null){\n                                    GameConfig.auths_Btn = wx.createUserInfoButton({\n                                        type: 'image',\n                                        image: 'https://st.gwold.com/wfclb/ninja/pic/authorBtn.png',\n                                        style: {\n                                            left: width/2-30-Math.floor(250*width/750),\n                                            top: height/2-30-Math.floor(500*height/1206),\n                                            width:60,\n                                            height:60\n                                        }\n                                    })\n                                    GameConfig.auths_Btn.onTap((res1) => {\n                                        wx.getSetting({\n                                            success(auths){\n                                                if(auths.authSetting[\"scope.userInfo\"]){\n                                                    console.log(\"==已经授权===\")\n                                                    GameConfig.IS_AUTHORIZE = true;\n                                                    GameConfig.auths_Btn.hide();\n                                                    var userInfo=cc.director.getScene().children[0].getChildByName(\"userInfo\");\n                                                    userInfo.active = true\n                                                    //将用户信息传至开发者服务器\n                                                    _this.sendUserInfo();\n                                                }\n                                                else{\n                                                    console.log(\"==拒绝授权===\")\n                                                }\n                                            }\n                                        })\n                                    })\n                                    GameConfig.auths_Btn.show()\n                                }\n                            }\n                        })\n                    }\n                },\n                fail:function () {\n                    Util.gameLog(\"wx.getSetting调用失败\")\n                }\n            })\n        }\n        else{\n            console.log(\"当前已手动授权\")\n            this.node.active = true;\n            if(GameConfig.auths_Btn){\n                GameConfig.auths_Btn.hide();\n            }\n            this.nickName.string = GameConfig.userInfo.nickName;\n            cc.loader.load(GameConfig.userInfo.avatarUrl, function (err, texture) {\n                var sprite  = new cc.SpriteFrame(texture);\n                _this.avatar.spriteFrame = sprite;\n            });\n        }\n    },\n    //微信已授权开发者服务器登录\n    loginWithWxAuthorize(){\n        console.log(\"已授权登陆开始\");\n        var _this = this;\n        this.getUserInfo(function (){\n            wx.request({\n                url:GameConfig.INTER_URL+\"login\",\n                data:{\n                    'code':GameConfig.userInfo.code,\n                    'nickName':GameConfig.userInfo.nickName,\n                    'headImg':GameConfig.userInfo.avatarUrl,\n                    'country':GameConfig.userInfo.country,\n                    'province':GameConfig.userInfo.province,\n                    'city':GameConfig.userInfo.city,\n                    'sex':GameConfig.userInfo.sex,\n                    'shareCode':GameConfig.enterShareConfig.enterShareCode\n                },\n                method:\"POST\",\n                header: {\n                    'content-type': 'application/x-www-form-urlencoded'\n                },\n                success:function (res) {\n                    console.log('登陆完成后返回值：',res.data)\n                    if(res.data.status == 1){\n                        wx.setStorageSync('sessionId',res.data.data.sessionId);\n                        wx.setStorageSync('shareCode',res.data.data.shareCode)\n                    }\n                    else\n                    {\n                        switch(res.data.code){\n                            case 1006:\n                                Util.gameLog(\"登录操作失败\")\n                                break;\n                            case 1005:\n                                Util.gameLog(\"登录参数错误\")\n                                break;\n                        }\n                    }\n                },\n                error:function () {\n                    Util.gameLog(\"/login接口调用失败\")\n                }\n            })\n        })\n    },\n    //微信未授权开发者服务器登录\n    loginWithoutWxAuthorize(){\n        console.log(\"未授权登陆开始\");\n        var _this = this;\n        wx.request({\n            url:GameConfig.INTER_URL+\"login\",\n            data:{\n                'code':GameConfig.userInfo.code,\n                'shareCode':GameConfig.enterShareConfig.enterShareCode\n            },\n            method:\"POST\",\n            header: {\n                'content-type': 'application/x-www-form-urlencoded'\n            },\n            success:function (res) {\n                console.log('微信未授权登陆完成后返回值：',res.data)\n                if(res.data.status == 1){\n                    wx.setStorageSync('sessionId',res.data.data.sessionId);\n                    wx.setStorageSync('shareCode',res.data.data.shareCode)\n                }\n                else {\n                    switch(res.data.code){\n                        case 1006:\n                            Util.gameLog(\"登录操作失败\")\n                            break;\n                            case 1005:\n                                Util.gameLog(\"登录参数错误\")\n                                break;\n                    }\n                            }\n                        },\n            error:function () {\n                Util.gameLog(\"/login接口调用失败\")\n            }\n\n        })\n    },\n    //发送用户信息\n    sendUserInfo(){\n        console.log(\"将用户信息传送至开发者服务器开始\")\n        var _this = this;\n        var userInfo = cc.director.getScene().children[0].getChildByName(\"userInfo\");\n        var nickName = userInfo.getChildByName(\"nickName\").getComponent(cc.Label);\n        var avatar = userInfo.getChildByName(\"mask\").getChildByName(\"avatar\").getComponent(cc.Sprite);\n        this.getUserInfo(\n            function () {\n            nickName.string = GameConfig.userInfo.nickName;\n            cc.loader.load(GameConfig.userInfo.avatarUrl, function (err, texture) {\n                var sprite  = new cc.SpriteFrame(texture);\n                avatar.spriteFrame = sprite;\n            });\n            //将用户信息传至开发者服务器\n            wx.request({\n                url:GameConfig.INTER_URL+\"info\",\n                data:{\n                    'nickName':GameConfig.userInfo.nickName,\n                    'headImg':GameConfig.userInfo.avatarUrl,\n                    'country':GameConfig.userInfo.country,\n                    'province':GameConfig.userInfo.province,\n                    'city':GameConfig.userInfo.city,\n                    'sex':GameConfig.userInfo.sex\n                },\n                method:\"POST\",\n                header: {\n                    'content-type': 'application/x-www-form-urlencoded',\n                    'Cookie':\"SESSION=\"+wx.getStorageSync('sessionId')\n                },\n                success:function (res){\n                    console.log(\"用户信息传至开发者服务器返回值\",res.data)\n                    if(res.data.status == 1){\n                    }\n                    else{\n                        switch(res.data.code){\n                            case 1006:\n                                Util.gameLog(\"用户信息传送操作失败\")\n                            case 1005:\n                                Util.gameLog(\"用户信息传送参数错误\")\n                        }\n                    }\n                },\n                error:function () {\n                    Util.gameLog(\"/info接口调用失败\")\n                }\n            })\n        })\n    },\n    //获取用户信息\n    getUserInfo(callBacks){\n        console.log(\"获取个人信息开始\")\n        var callback = callBacks;\n        wx.getUserInfo({\n            success: function(res){\n                console.log(\"获取用户信息返回值\",res)\n                GameConfig.userInfo.nickName = res.userInfo.nickName;\n                GameConfig.userInfo.avatarUrl = res.userInfo.avatarUrl+'?aaa=aa.jpg';\n                GameConfig.userInfo.country = res.userInfo.country;\n                GameConfig.userInfo.province = res.userInfo.province;\n                GameConfig.userInfo.city = res.userInfo.city;\n                GameConfig.userInfo.sex = res.userInfo.gender;\n                if(res.userInfo.gender = '')\n                {\n                    GameConfig.userInfo.sex = -1\n                }\n                console.log(GameConfig)\n                callback && callback();\n            }\n        })\n    },\n    checkLogin(callbacks){\n        wx.request({\n            url:GameConfig.INTER_URL+\"checkLogin\",\n            method:\"POST\",\n            header:{\n                'content-type': 'application/x-www-form-urlencoded'\n            },\n            success:function (res){\n                console.log('检查登陆返回值：',res.data.data)\n                if(res.data.data == 1){\n                    console.log(\"您已登陆，无须再登陆\")\n                }\n                else if(res.data.data == 0){\n                    callbacks && callbacks();\n                }\n            },\n            fail:function () {\n                Util.gameLog(\"checkLogin接口调用失败\")\n            }\n        })\n    },\n    login(){\n        var _this = this;\n        if(!GameConfig.haveCheckLogin) {\n            wx.checkSession({\n                //session_key 未过期\n                success() {\n                    console.log(\"session_key未过期\")\n                    wx.request({\n                        url: GameConfig.INTER_URL + \"checkLogin\",\n                        method: \"POST\",\n                        header: {\n                            'content-type': 'application/x-www-form-urlencoded'\n                        },\n                        success: function (res) {\n                            console.log(res.data)\n                            GameConfig.haveCheckLogin = true;\n                            //已登录\n                            if (res.data.status == 1 && res.data.data == 1) {\n                                console.log(\"已登陆\")\n                                _this.loginedSetting()\n                            }\n                            //未登录\n                            else if (res.data.status == 1 && res.data.data == 0) {\n                                console.log(\"未登陆\")\n                                wx.login({\n                                    success(res) {\n                                        GameConfig.userInfo.code = res.code;\n                                        _this.unLoginedSetting();\n                                    }\n                                })\n                            }\n                        },\n                        fail: function () {\n                            Util.gameLog(\"checkLogin接口调用失败\")\n                        }\n                    })\n                },\n                //session_key 已过期\n                fail() {\n                    console.log(\"session_key已过期\")\n                    wx.login({\n                        success(res) {\n                            GameConfig.userInfo.code = res.code;\n                            GameConfig.haveCheckLogin = true;\n                            _this.unLoginedSetting()\n                        }\n                    })\n                }\n            })\n        }\n        else{\n            this.loginedSetting();\n        }\n    }\n});\n"]}