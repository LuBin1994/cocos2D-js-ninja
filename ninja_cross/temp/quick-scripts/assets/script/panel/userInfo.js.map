{"version":3,"sources":["userInfo.js"],"names":["cc","Class","extends","Component","properties","nickName","Label","avatar","Sprite","onLoad","_this","node","active","login","e","Util","gameLog","unLoginedSetting","GameConfig","IS_AUTHORIZE","wx","getSetting","success","res","authSetting","console","log","loginWithWxAuthorize","getUserInfo","userInfo","avatarUrl","string","loader","load","err","texture","sprite","SpriteFrame","spriteFrame","loginWithoutWxAuthorize","getSystemInfo","width","screenWidth","height","screenHeight","auths_Btn","createUserInfoButton","type","image","style","left","Math","floor","top","onTap","res1","auths","hide","director","getScene","children","getChildByName","sendUserInfo","show","fail","loginedSetting","request","url","INTER_URL","data","code","country","province","city","sex","enterShareConfig","enterShareCode","method","header","status","setStorageSync","sessionId","shareCode","error","info","getComponent","getStorageSync","callBacks","callback","gender","checkLogin","callbacks","haveCheckLogin","checkSession"],"mappings":"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","file":"userInfo.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\panel","sourcesContent":["import GameConfig from '../gameConfig';\r\nimport Util from '../utils/util'\r\ncc.Class({\r\n    extends: cc.Component,\r\n    properties: {\r\n        nickName: cc.Label,\r\n        avatar: cc.Sprite\r\n    },\r\n    onLoad() {\r\n        var _this = this\r\n        this.node.active = false;\r\n        try {\r\n            _this.login();\r\n        }\r\n        catch (e) {\r\n            Util.gameLog(\"用户授权模块错误\")\r\n        }\r\n    },\r\n    //未登陆处理\r\n    unLoginedSetting() {\r\n        var _this = this\r\n        if (GameConfig.IS_AUTHORIZE == false) {\r\n            wx.getSetting({\r\n                success: function (res) {\r\n                    //已经授权\r\n                    if (res.authSetting['scope.userInfo']) {\r\n                        console.log('==已获得登录权限==')\r\n                        _this.node.active = true;\r\n                        GameConfig.IS_AUTHORIZE = true;\r\n                        _this.loginWithWxAuthorize();\r\n                        //获取用户信息,显示头像\r\n                        wx.getUserInfo({\r\n                            success: function (res) {\r\n                                GameConfig.userInfo.nickName = res.userInfo.nickName;\r\n                                GameConfig.userInfo.avatarUrl = res.userInfo.avatarUrl + '?aaa=aa.jpg';\r\n                                _this.nickName.string = res.userInfo.nickName;\r\n                                cc.loader.load(GameConfig.userInfo.avatarUrl, function (err, texture) {\r\n                                    var sprite = new cc.SpriteFrame(texture);\r\n                                    _this.avatar.spriteFrame = sprite;\r\n                                });\r\n                            }\r\n                        })\r\n                    }\r\n                    //未授权\r\n                    else {\r\n                        _this.loginWithoutWxAuthorize();\r\n                        //获取手机信息\r\n                        wx.getSystemInfo({\r\n                            success(res) {\r\n                                var width = res.screenWidth;\r\n                                var height = res.screenHeight;\r\n                                console.log(width, height)\r\n                                if (GameConfig.auths_Btn == null) {\r\n                                    GameConfig.auths_Btn = wx.createUserInfoButton({\r\n                                        type: 'image',\r\n                                        image: 'https://st.gwold.com/wfclb/ninja/pic/authorBtn.png',\r\n                                        style: {\r\n                                            left: width / 2 - 30 - Math.floor(250 * width / 750),\r\n                                            top: height / 2 - 30 - Math.floor(500 * height / 1206),\r\n                                            width: 60,\r\n                                            height: 60\r\n                                        }\r\n                                    })\r\n                                    GameConfig.auths_Btn.onTap((res1) => {\r\n                                        wx.getSetting({\r\n                                            success(auths) {\r\n                                                if (auths.authSetting[\"scope.userInfo\"]) {\r\n                                                    console.log(\"==已经授权===\")\r\n                                                    GameConfig.IS_AUTHORIZE = true;\r\n                                                    GameConfig.auths_Btn.hide();\r\n                                                    var userInfo = cc.director.getScene().children[0].getChildByName(\"userInfo\");\r\n                                                    userInfo.active = true\r\n                                                    //将用户信息传至开发者服务器\r\n                                                    _this.sendUserInfo();\r\n                                                }\r\n                                                else {\r\n                                                    console.log(\"==拒绝授权===\")\r\n                                                }\r\n                                            }\r\n                                        })\r\n                                    })\r\n                                    GameConfig.auths_Btn.show()\r\n                                }\r\n                            }\r\n                        })\r\n                    }\r\n                },\r\n                fail: function () {\r\n                    Util.gameLog(\"wx.getSetting调用失败\")\r\n                }\r\n            })\r\n        }\r\n        else {\r\n            console.log(\"当前已手动授权\")\r\n            this.node.active = true;\r\n            if (GameConfig.auths_Btn) {\r\n                GameConfig.auths_Btn.hide();\r\n            }\r\n            this.nickName.string = GameConfig.userInfo.nickName;\r\n            cc.loader.load(GameConfig.userInfo.avatarUrl, function (err, texture) {\r\n                var sprite = new cc.SpriteFrame(texture);\r\n                _this.avatar.spriteFrame = sprite;\r\n            });\r\n        }\r\n    },\r\n    //已登陆处理\r\n    loginedSetting() {\r\n        var _this = this\r\n        if (GameConfig.IS_AUTHORIZE == false) {\r\n            wx.getSetting({\r\n                success: function (res) {\r\n                    //已经授权\r\n                    if (res.authSetting['scope.userInfo']) {\r\n                        console.log('==已获得登录权限==')\r\n                        _this.node.active = true;\r\n                        GameConfig.IS_AUTHORIZE = true;\r\n                        //获取用户信息,显示头像\r\n                        wx.getUserInfo({\r\n                            success: function (res) {\r\n                                GameConfig.userInfo.nickName = res.userInfo.nickName;\r\n                                GameConfig.userInfo.avatarUrl = res.userInfo.avatarUrl + '?aaa=aa.jpg';\r\n                                _this.nickName.string = res.userInfo.nickName;\r\n                                cc.loader.load(GameConfig.userInfo.avatarUrl, function (err, texture) {\r\n                                    var sprite = new cc.SpriteFrame(texture);\r\n                                    _this.avatar.spriteFrame = sprite;\r\n                                });\r\n                            }\r\n                        })\r\n                    }\r\n                    //未授权\r\n                    else {\r\n                        //获取手机信息\r\n                        wx.getSystemInfo({\r\n                            success(res) {\r\n                                var width = res.screenWidth;\r\n                                var height = res.screenHeight;\r\n                                console.log(width, height)\r\n                                if (GameConfig.auths_Btn == null) {\r\n                                    GameConfig.auths_Btn = wx.createUserInfoButton({\r\n                                        type: 'image',\r\n                                        image: 'https://st.gwold.com/wfclb/ninja/pic/authorBtn.png',\r\n                                        style: {\r\n                                            left: width / 2 - 30 - Math.floor(250 * width / 750),\r\n                                            top: height / 2 - 30 - Math.floor(500 * height / 1206),\r\n                                            width: 60,\r\n                                            height: 60\r\n                                        }\r\n                                    })\r\n                                    GameConfig.auths_Btn.onTap((res1) => {\r\n                                        wx.getSetting({\r\n                                            success(auths) {\r\n                                                if (auths.authSetting[\"scope.userInfo\"]) {\r\n                                                    console.log(\"==已经授权===\")\r\n                                                    GameConfig.IS_AUTHORIZE = true;\r\n                                                    GameConfig.auths_Btn.hide();\r\n                                                    var userInfo = cc.director.getScene().children[0].getChildByName(\"userInfo\");\r\n                                                    userInfo.active = true\r\n                                                    //将用户信息传至开发者服务器\r\n                                                    _this.sendUserInfo();\r\n                                                }\r\n                                                else {\r\n                                                    console.log(\"==拒绝授权===\")\r\n                                                }\r\n                                            }\r\n                                        })\r\n                                    })\r\n                                    GameConfig.auths_Btn.show()\r\n                                }\r\n                            }\r\n                        })\r\n                    }\r\n                },\r\n                fail: function () {\r\n                    Util.gameLog(\"wx.getSetting调用失败\")\r\n                }\r\n            })\r\n        }\r\n        else {\r\n            console.log(\"当前已手动授权\")\r\n            this.node.active = true;\r\n            if (GameConfig.auths_Btn) {\r\n                GameConfig.auths_Btn.hide();\r\n            }\r\n            this.nickName.string = GameConfig.userInfo.nickName;\r\n            cc.loader.load(GameConfig.userInfo.avatarUrl, function (err, texture) {\r\n                var sprite = new cc.SpriteFrame(texture);\r\n                _this.avatar.spriteFrame = sprite;\r\n            });\r\n        }\r\n    },\r\n    //微信已授权开发者服务器登录\r\n    loginWithWxAuthorize() {\r\n        console.log(\"已授权登陆开始\");\r\n        var _this = this;\r\n        this.getUserInfo(function () {\r\n            wx.request({\r\n                url: GameConfig.INTER_URL + \"login\",\r\n                data: {\r\n                    'code': GameConfig.userInfo.code,\r\n                    'nickName': GameConfig.userInfo.nickName,\r\n                    'headImg': GameConfig.userInfo.avatarUrl,\r\n                    'country': GameConfig.userInfo.country,\r\n                    'province': GameConfig.userInfo.province,\r\n                    'city': GameConfig.userInfo.city,\r\n                    'sex': GameConfig.userInfo.sex,\r\n                    'shareCode': GameConfig.enterShareConfig.enterShareCode\r\n                },\r\n                method: \"POST\",\r\n                header: {\r\n                    'content-type': 'application/x-www-form-urlencoded'\r\n                },\r\n                success: function (res) {\r\n                    console.log('登陆完成后返回值：', res.data)\r\n                    if (res.data.status == 1) {\r\n                        wx.setStorageSync('sessionId', res.data.data.sessionId);\r\n                        wx.setStorageSync('shareCode', res.data.data.shareCode)\r\n                    }\r\n                    else {\r\n                        switch (res.data.code) {\r\n                            case 1006:\r\n                                Util.gameLog(\"登录操作失败\")\r\n                                break;\r\n                            case 1005:\r\n                                Util.gameLog(\"登录参数错误\")\r\n                                break;\r\n                        }\r\n                    }\r\n                },\r\n                error: function () {\r\n                    Util.gameLog(\"/login接口调用失败\")\r\n                }\r\n            })\r\n        })\r\n    },\r\n    //微信未授权开发者服务器登录\r\n    loginWithoutWxAuthorize() {\r\n        console.log(\"未授权登陆开始\");\r\n        var _this = this;\r\n        wx.request({\r\n            url: GameConfig.INTER_URL + \"login\",\r\n            data: {\r\n                'code': GameConfig.userInfo.code,\r\n                'shareCode': GameConfig.enterShareConfig.enterShareCode\r\n            },\r\n            method: \"POST\",\r\n            header: {\r\n                'content-type': 'application/x-www-form-urlencoded'\r\n            },\r\n            success: function (res) {\r\n                console.log('微信未授权登陆完成后返回值：', res.data)\r\n                if (res.data.status == 1) {\r\n                    wx.setStorageSync('sessionId', res.data.data.sessionId);\r\n                    wx.setStorageSync('shareCode', res.data.data.shareCode)\r\n                }\r\n                else {\r\n                    Util.gameLog(res.data.info)\r\n                }\r\n            },\r\n            error: function () {\r\n                Util.gameLog(\"/login接口调用失败\")\r\n            }\r\n        })\r\n    },\r\n    //发送用户信息\r\n    sendUserInfo() {\r\n        console.log(\"将用户信息传送至开发者服务器开始\")\r\n        var _this = this;\r\n        var userInfo = cc.director.getScene().children[0].getChildByName(\"userInfo\");\r\n        var nickName = userInfo.getChildByName(\"nickName\").getComponent(cc.Label);\r\n        var avatar = userInfo.getChildByName(\"mask\").getChildByName(\"avatar\").getComponent(cc.Sprite);\r\n        this.getUserInfo(\r\n            function () {\r\n                nickName.string = GameConfig.userInfo.nickName;\r\n                cc.loader.load(GameConfig.userInfo.avatarUrl, function (err, texture) {\r\n                    var sprite = new cc.SpriteFrame(texture);\r\n                    avatar.spriteFrame = sprite;\r\n                });\r\n                //将用户信息传至开发者服务器\r\n                wx.request({\r\n                    url: GameConfig.INTER_URL + \"info\",\r\n                    data: {\r\n                        'nickName': GameConfig.userInfo.nickName,\r\n                        'headImg': GameConfig.userInfo.avatarUrl,\r\n                        'country': GameConfig.userInfo.country,\r\n                        'province': GameConfig.userInfo.province,\r\n                        'city': GameConfig.userInfo.city,\r\n                        'sex': GameConfig.userInfo.sex\r\n                    },\r\n                    method: \"POST\",\r\n                    header: {\r\n                        'content-type': 'application/x-www-form-urlencoded',\r\n                        'Cookie': \"SESSION=\" + wx.getStorageSync('sessionId')\r\n                    },\r\n                    success: function (res) {\r\n                        console.log(\"用户信息传至开发者服务器返回值\", res.data)\r\n                        if (res.data.status == 1) {\r\n                        }\r\n                        else {\r\n                            Util.gameLog(res.data.info)\r\n                        }\r\n                    },\r\n                    error: function () {\r\n                        Util.gameLog(\"/info接口调用失败\")\r\n                    }\r\n                })\r\n            })\r\n    },\r\n    //获取用户信息\r\n    getUserInfo(callBacks) {\r\n        console.log(\"获取个人信息开始\")\r\n        var callback = callBacks;\r\n        wx.getUserInfo({\r\n            success: function (res) {\r\n                console.log(\"获取用户信息返回值\", res)\r\n                GameConfig.userInfo.nickName = res.userInfo.nickName;\r\n                GameConfig.userInfo.avatarUrl = res.userInfo.avatarUrl + '?aaa=aa.jpg';\r\n                GameConfig.userInfo.country = res.userInfo.country;\r\n                GameConfig.userInfo.province = res.userInfo.province;\r\n                GameConfig.userInfo.city = res.userInfo.city;\r\n                GameConfig.userInfo.sex = res.userInfo.gender;\r\n                if (res.userInfo.gender = '') {\r\n                    GameConfig.userInfo.sex = -1\r\n                }\r\n                console.log(GameConfig)\r\n                callback && callback();\r\n            }\r\n        })\r\n    },\r\n    checkLogin(callbacks) {\r\n        wx.request({\r\n            url: GameConfig.INTER_URL + \"checkLogin\",\r\n            method: \"POST\",\r\n            header: {\r\n                'content-type': 'application/x-www-form-urlencoded'\r\n            },\r\n            success: function (res) {\r\n                console.log('检查登陆返回值：', res.data.data)\r\n                if (res.data.data == 1) {\r\n                    console.log(\"您已登陆，无须再登陆\")\r\n                }\r\n                else if (res.data.data == 0) {\r\n                    callbacks && callbacks();\r\n                }\r\n            },\r\n            fail: function () {\r\n                Util.gameLog(\"checkLogin接口调用失败\")\r\n            }\r\n        })\r\n    },\r\n    login() {\r\n        var _this = this;\r\n        if (!GameConfig.haveCheckLogin) {\r\n            wx.checkSession({\r\n                //session_key 未过期\r\n                success() {\r\n                    console.log(\"session_key未过期\")\r\n                    wx.request({\r\n                        url: GameConfig.INTER_URL + \"checkLogin\",\r\n                        method: \"POST\",\r\n                        header: {\r\n                            'content-type': 'application/x-www-form-urlencoded'\r\n                        },\r\n                        success: function (res) {\r\n                            console.log(res.data)\r\n                            GameConfig.haveCheckLogin = true;\r\n                            //已登录\r\n                            if (res.data.status == 1 && res.data.data == 1) {\r\n                                console.log(\"已登陆\")\r\n                                _this.loginedSetting()\r\n                            }\r\n                            //未登录\r\n                            else if (res.data.status == 1 && res.data.data == 0) {\r\n                                console.log(\"未登陆\")\r\n                                wx.login({\r\n                                    success(res) {\r\n                                        GameConfig.userInfo.code = res.code;\r\n                                        _this.unLoginedSetting();\r\n                                    }\r\n                                })\r\n                            }\r\n                        },\r\n                        fail: function () {\r\n                            Util.gameLog(\"checkLogin接口调用失败\")\r\n                        }\r\n                    })\r\n                },\r\n                //session_key 已过期\r\n                fail() {\r\n                    console.log(\"session_key已过期\")\r\n                    wx.login({\r\n                        success(res) {\r\n                            GameConfig.userInfo.code = res.code;\r\n                            GameConfig.haveCheckLogin = true;\r\n                            _this.unLoginedSetting()\r\n                        }\r\n                    })\r\n                }\r\n            })\r\n        }\r\n        else {\r\n            this.loginedSetting();\r\n        }\r\n    }\r\n});\r\n"]}