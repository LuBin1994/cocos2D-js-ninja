{"version":3,"sources":["userInfo.js"],"names":["cc","Class","extends","Component","properties","nickName","Label","avatar","Sprite","onLoad","getUserInfo","start","_this","GameConfig","avatarUrl","wx","authorize","scope","success","getSetting","res","authSetting","userInfo","string","loader","load","err","texture","sprite","SpriteFrame","spriteFrame"],"mappings":";;;;;;AAAA;;;;;;AACAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;AAELC,gBAAY;AACRC,kBAASL,GAAGM,KADJ;AAERC,gBAAOP,GAAGQ;AAFF,KAFP;AAMLC,UANK,oBAMK;AACN,aAAKC,WAAL;AACH,KARI;AASLC,SATK,mBASI,CAAE,CATN;;AAUL;AACAD,iBAAY,uBAAY;AACpB,YAAIE,QAAQ,IAAZ;AACA,YAAGC,qBAAWR,QAAX,IAAuB,IAAvB,IAA+BQ,qBAAWC,SAAX,IAAwB,IAA1D,EAA+D;AAC3DC,eAAGC,SAAH,CAAa;AACTC,uBAAM,gBADG;AAETC,yBAAQ,mBAAY;AAChBH,uBAAGI,UAAH,CAAc;AACVD,iCAAS,iBAASE,GAAT,EAAa;AAClB,gCAAIA,IAAIC,WAAJ,CAAgB,gBAAhB,CAAJ,EAAuC;AACnC;AACAN,mCAAGL,WAAH,CAAe;AACXQ,6CAAS,iBAASE,GAAT,EAAc;AACnBP,6DAAWR,QAAX,GAAsBe,IAAIE,QAAJ,CAAajB,QAAnC;AACAQ,6DAAWC,SAAX,GAAuBM,IAAIE,QAAJ,CAAaR,SAAb,GAAuB,aAA9C;AACAF,8CAAMP,QAAN,CAAekB,MAAf,GAAwBH,IAAIE,QAAJ,CAAajB,QAArC;AACAL,2CAAGwB,MAAH,CAAUC,IAAV,CAAeZ,qBAAWC,SAA1B,EAAqC,UAAUY,GAAV,EAAeC,OAAf,EAAwB;AACzD,gDAAIC,SAAU,IAAI5B,GAAG6B,WAAP,CAAmBF,OAAnB,CAAd;AACAf,kDAAML,MAAN,CAAauB,WAAb,GAA2BF,MAA3B;AACH,yCAHD;AAIH;AATU,iCAAf;AAWH;AACJ;AAhBS,qBAAd;AAkBH;AArBQ,aAAb;AAuBH,SAxBD,MAyBI;AACA,iBAAKvB,QAAL,CAAckB,MAAd,GAAuBV,qBAAWR,QAAlC;AACAL,eAAGwB,MAAH,CAAUC,IAAV,CAAeZ,qBAAWC,SAA1B,EAAqC,UAAUY,GAAV,EAAeC,OAAf,EAAwB;AACzD,oBAAIC,SAAU,IAAI5B,GAAG6B,WAAP,CAAmBF,OAAnB,CAAd;AACAf,sBAAML,MAAN,CAAauB,WAAb,GAA2BF,MAA3B;AACH,aAHD;AAIH;AACJ;AACD;AA9CK,CAAT","file":"userInfo.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\panel","sourcesContent":["import GameConfig from '../gameConfig';\ncc.Class({\n    extends: cc.Component,\n    properties: {\n        nickName:cc.Label,\n        avatar:cc.Sprite\n    },\n    onLoad () {\n        this.getUserInfo();\n    },\n    start () {},\n    //获取微信头像昵称\n    getUserInfo:function () {\n        var _this = this;\n        if(GameConfig.nickName == null && GameConfig.avatarUrl == null){\n            wx.authorize({\n                scope:\"scope.userInfo\",\n                success:function () {\n                    wx.getSetting({\n                        success: function(res){\n                            if (res.authSetting['scope.userInfo']) {\n                                // 已经授权，可以直接调用 getUserInfo 获取头像昵称\n                                wx.getUserInfo({\n                                    success: function(res) {\n                                        GameConfig.nickName = res.userInfo.nickName;\n                                        GameConfig.avatarUrl = res.userInfo.avatarUrl+'?aaa=aa.jpg';\n                                        _this.nickName.string = res.userInfo.nickName;\n                                        cc.loader.load(GameConfig.avatarUrl, function (err, texture) {\n                                            var sprite  = new cc.SpriteFrame(texture);\n                                            _this.avatar.spriteFrame = sprite;\n                                        });\n                                    }\n                                })\n                            }\n                        }\n                    })\n                }\n            })\n        }\n        else{\n            this.nickName.string = GameConfig.nickName;\n            cc.loader.load(GameConfig.avatarUrl, function (err, texture) {\n                var sprite  = new cc.SpriteFrame(texture);\n                _this.avatar.spriteFrame = sprite;\n            });\n        }\n    },\n    // update (dt) {},\n});\n"]}